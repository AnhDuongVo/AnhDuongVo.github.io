{{/* pull in the original partial first */}}
{{ $orig := partial "blocks/_internal/resume-biography-3.html" . }}
{{ $orig | safeHTML }}

{{/* Inject affiliations below the socials in the left column */}}
{{ $author := site.GetPage (printf "authors/%s" (.content.username | default "admin")) }}
{{ with $author.Params.affiliations }}
  <style>
    .hbxbio-side-affiliations {
      display:flex; flex-direction:column; align-items:center; gap:10px; margin-top:12px;
    }
    .hbxbio-side-affiliations img {
      height:22px; max-width:120px; object-fit:contain; filter:grayscale(100%);
      opacity:.85; transition:all .2s ease-in-out;
    }
    .hbxbio-side-affiliations a:hover img { filter:none; opacity:1; transform:scale(1.05); }
  </style>
  <script>
    // Find the sidebar column and append our affiliations block
    document.addEventListener('DOMContentLoaded', function () {
      const side = document.querySelector('.hb-resume-bio .col-12.col-lg-4, .hb-resume-bio .col-3, .hb-resume-bio .sidebar');
      if (!side || document.querySelector('.hbxbio-side-affiliations')) return;
      const wrap = document.createElement('div'); wrap.className = 'hbxbio-side-affiliations';
      wrap.innerHTML = `
        {{ range . }}
          <a href="{{ .url }}" target="_blank" rel="noopener" aria-label="{{ .name }}">
            <img src="{{ .logo }}" alt="{{ .name }}">
          </a>
        {{ end }}
      `;
      side.appendChild(wrap);
    });
  </script>
{{ end }}
